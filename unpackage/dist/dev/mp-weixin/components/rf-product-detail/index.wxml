<view class="rf-product-detail"><text data-event-opts="{{[['tap',[['navBack',['$event']]]]]}}" class="back-btn iconfont iconzuo" bindtap="__e"></text><block wx:if="{{product.name}}"><view class="detail"><view class="carousel"><swiper indicator-dots="{{true}}" circular="true" duration="400" controls="{{true}}" touchable="{{true}}"><block wx:for="{{$root.l0}}" wx:for-item="item" wx:for-index="index" wx:key="index"><swiper-item class="swiper-item"><view class="image-wrapper"><image class="loaded" src="{{item.$orig}}" mode="aspectFill"></image></view><uni-tag class="content" vue-id="{{'3a07b446-1-'+index}}" circle="{{true}}" size="small" text="{{index+1+'  / '+item.g0}}" bind:__l="__l"></uni-tag></swiper-item></block></swiper></view><view class="introduce-section"><view class="introduce-first-line"><block wx:if="{{product.point_exchange_type==4}}"><view class="price-box point-box">该商品仅需<text class="price">{{product.point_exchange+" 积分"}}</text></view></block><block wx:else><view class="price-box"><view class="price-first-line"><block wx:if="{{product.memberDiscount!=[]&&product.memberDiscount&&product.memberDiscount.discount>0&&userInfo}}"><image class="member-level" mode="aspectFit" src="{{vipPrice}}"></image></block><text class="{{['price','text-'+themeColor.name]}}">{{moneySymbol+currentProductPrice}}</text></view><block wx:if="{{product.market_price>product.price}}"><view class="m-price-wrapper">价格<text class="m-price">{{moneySymbol+product.market_price}}</text></view></block></view></block><view data-event-opts="{{[['tap',[['toFavorite',['$event']]]]]}}" class="collect" bindtap="__e"><view class="{{['iconfont',favorite?'text-'+themeColor.name+' iconshixin1':'iconguanzhu']}}"></view><text>收藏</text></view></view><view class="introduce-second-line"><view class="title"><text>{{product.name}}</text><text class="sketch">{{product.sketch}}</text></view><view class="share"><rf-tag vue-id="3a07b446-2" type="gray" size="small" tui-tag-class="tui-tag-share tui-size" shape="circleLeft" bind:__l="__l" vue-slots="{{['default']}}"><button class="{{['share-btn','text-'+themeColor.name]}}" open-type="share" data-event-opts="{{[['tap',[['share']]]]}}" catchtap="__e"><text class="iconfont iconfenxiang"></text><text class="tui-share-text tui-gray">分享</text></button></rf-tag></view></view><view class="product-tag"><uni-tag class="tag" vue-id="3a07b446-3" circle="{{true}}" type="base" text="生成海报" size="small" data-event-opts="{{[['^tap',[['openPoster']]]]}}" bind:tap="__e" bind:__l="__l"></uni-tag></view><block wx:if="{{product}}"><view class="data"><text class="item">{{"快递: "+(product.shipping_type==='1'?'包邮':'买家自付')}}</text><text class="item">{{"月销 "+product.total_sales}}</text><block wx:if="{{product.address_name}}"><text class="item in1line">{{product.address_name}}</text></block></view></block></view><view class="c-list"><block wx:if="{{$root.m0==1}}"><rf-item-popup vue-id="3a07b446-4" title="商品库存" isEmpty="{{$root.m1===0}}" empty="库存不足" bind:__l="__l" vue-slots="{{['content']}}"><view slot="content">{{''+(currentStock||product.stock||0)+" "+(product.unit||'件')+''}}</view></rf-item-popup></block><block wx:if="{{$root.g1>0}}"><rf-item-popup vue-id="3a07b446-5" title="满减送" specClass="{{fullGiveClass}}" data-event-opts="{{[['^hide',[['hideService']]],['^show',[['showPopupService',['fullGiveClass','$0'],['product.fullGiveRule']]]]]}}" bind:hide="__e" bind:show="__e" bind:__l="__l" vue-slots="{{['default','content','popup']}}"><view class="con-list" slot="content"><text class="{{['text-'+themeColor.name]}}">{{product.fullGiveRule[0]}}</text></view><block wx:if="{{$root.g2>0}}"><view slot="right"><text class="iconfont iconyou"></text></view></block><view class="service" slot="popup"><view class="content"><block wx:for="{{product.fullGiveRule}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view class="row"><text>{{item}}</text></view></block></view><button data-event-opts="{{[['tap',[['hideService',['$event']]]]]}}" class="{{['btn','bg-'+themeColor.name]}}" bindtap="__e">完成</button></view></rf-item-popup></block><block wx:if="{{product.fullMail&&product.fullMail.is_open==='1'&&product.shipping_type!=='1'}}"><rf-item-popup vue-id="3a07b446-6" title="满包邮" bind:__l="__l" vue-slots="{{['content']}}"><view class="{{['text-'+themeColor.name]}}" slot="content">{{"满"+product.fullMail.full_mail_money+"元包邮"}}</view></rf-item-popup></block><rf-item-popup vue-id="3a07b446-7" title="购买类型" specClass="{{specClass}}" data-event-opts="{{[['^hide',[['hideService']]],['^show',[['toggleSpec']]]]}}" bind:hide="__e" bind:show="__e" bind:__l="__l" vue-slots="{{['content','right','popup']}}"><view slot="content"><block wx:if="{{currentSkuName===singleSkuText}}"><text class="selected-text">{{currentCartCount+" "+(product.unit||'件')}}</text></block><block wx:else><block wx:if="{{currentSkuName}}"><text class="selected-text">{{currentSkuName+" * "+currentCartCount}}</text></block><block wx:else><text class="selected-text">请选择规格</text></block></block></view><view slot="right"><text class="iconfont iconyou"></text></view><view slot="popup" data-event-opts="{{[['tap',[['stopPrevent',['$event']]]]]}}" catchtap="__e"><rf-attr-content vue-id="{{('3a07b446-8')+','+('3a07b446-7')}}" type="{{type}}" product="{{product}}" minNum="{{minNum}}" maxNum="{{maxNum}}" data-event-opts="{{[['^toggle',[['toggleSpec']]]]}}" bind:toggle="__e" bind:__l="__l"></rf-attr-content></view></rf-item-popup><rf-item-popup vue-id="3a07b446-9" title="优惠券" specClass="{{couponClass}}" isEmpty="{{$root.g3===0}}" empty="暂无可领取优惠券" data-event-opts="{{[['^hide',[['hideService']]],['^show',[['showPopupService',['couponClass','$0'],['product.canReceiveCoupon']]]]]}}" bind:hide="__e" bind:show="__e" bind:__l="__l" vue-slots="{{['default','content','popup']}}"><view slot="content"><text class="con t-r">领取优惠券</text></view><block wx:if="{{$root.g4>0}}"><view slot="right"><text class="iconfont iconyou"></text></view></block><view class="service" slot="popup"><view class="sub-list valid"><block wx:for="{{$root.l1}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['getCoupon',['$0'],[[['product.canReceiveCoupon','',index]]]]]]]}}" class="row" catchtap="__e"><view class="carrier"><view class="title"><view><text class="{{['cell-icon','bg-'+themeColor.name]}}">{{item.m2===2?'限':'全'}}</text><text class="cell-title">{{item.$orig.title}}</text></view><view class="{{['text-'+themeColor.name]}}"><block wx:if="{{item.$orig.type==='1'}}"><text class="price">{{moneySymbol+item.$orig.money}}</text></block><block wx:else><text class="price-discount">{{item.$orig.discount/10+'折'}}</text></block></view></view><view class="term"><text>{{item.f0+" ~ "+item.f1}}</text><text class="at_least">{{"满"+item.$orig.at_least+"可用"}}</text></view><view class="usage"><text>{{''+(item.m3===2?'部分产品使用':'全场产品使用')+''}}</text><view>{{''+(item.m4===0?'不限':'每人限领'+item.$orig.max_fetch)+"\n\t\t\t\t\t\t\t\t\t\t\t已领"+item.$orig.get_count+''}}<block wx:if="{{item.$orig.percentage}}"><text class="last">{{"剩余"+item.$orig.percentage+"%"}}</text></block></view></view></view></view></block></view></view></rf-item-popup><block wx:if="{{$root.m5}}"><rf-item-popup vue-id="3a07b446-10" title="限购说明" bind:__l="__l" vue-slots="{{['content']}}"><view slot="content"><text>{{product.max_buy+' '+(product.unit||'件')}}</text></view></rf-item-popup></block><block wx:if="{{product.point_exchange_type!=='1'}}"><rf-item-popup vue-id="3a07b446-11" title="积分活动" bind:__l="__l" vue-slots="{{['content']}}"><view class="con-list" slot="content"><block wx:if="{{product.point_exchange_type}}"><text>{{"兑换类型: "+$root.f2}}</text></block><block wx:if="{{$root.m6>0}}"><text>{{"赠送类型: "+$root.f3}}</text></block><block wx:if="{{$root.m7>0}}"><text>{{"下单可获得: "+$root.f4+"积分"}}</text></block><block wx:if="{{product.point_exchange!=0}}"><text>{{"兑换所需积分: "+product.point_exchange+''}}</text></block><block wx:if="{{product.max_use_point!=0}}"><text>{{"可使用抵扣积分: "+product.max_use_point}}</text></block><block wx:if="{{product.point_exchange_type==3}}"><text data-event-opts="{{[['tap',[['addCart',['buy',true]]]]]}}" class="buy-now" bindtap="__e">积分兑换 >></text></block></view></rf-item-popup></block><block wx:if="{{$root.g5>0}}"><rf-item-popup vue-id="3a07b446-12" title="服务" specClass="{{serviceClass}}" data-event-opts="{{[['^hide',[['hideService']]],['^show',[['showPopupService',['serviceClass','$0'],['product.tags']]]]]}}" bind:hide="__e" bind:show="__e" bind:__l="__l" vue-slots="{{['default','content','popup']}}"><view slot="content"><text>{{product.tags[0]}}</text></view><block wx:if="{{$root.g6>0}}"><view slot="right"><text class="iconfont iconyou"></text></view></block><view class="service" slot="popup"><view class="content"><block wx:for="{{product.tags}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view class="row"><view class="description">{{item}}</view></view></block></view><button data-event-opts="{{[['tap',[['hideService',['$event']]]]]}}" class="{{['btn','bg-'+themeColor.name]}}" bindtap="__e">完成</button></view></rf-item-popup></block><block wx:if="{{$root.g7>0}}"><rf-item-popup vue-id="3a07b446-13" title="阶梯优惠" specClass="{{ladderPreferentialClass}}" data-event-opts="{{[['^hide',[['hideService']]],['^show',[['showPopupService',['ladderPreferentialClass','$0'],['product.ladderPreferential']]]]]}}" bind:hide="__e" bind:show="__e" bind:__l="__l" vue-slots="{{['default','content','popup']}}"><view class="con-list" slot="content"><text>{{'满'+(product.ladderPreferential&&product.ladderPreferential[0]&&product.ladderPreferential[0].quantity)+(product.unit||'件')+''}}<block wx:if="{{$root.m8===1}}"><text>{{'每'+(product.unit||'件')+"减"+(product.ladderPreferential&&product.ladderPreferential[0]&&product.ladderPreferential[0].price)+"元"}}</text></block><block wx:if="{{$root.m9===2}}"><text>{{'每'+(product.unit||'件')+$root.m10+"折"}}</text></block></text></view><block wx:if="{{$root.g8>0}}"><view slot="right"><text class="iconfont iconyou"></text></view></block><view class="service" slot="popup"><view class="content"><block wx:for="{{$root.l2}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view class="row"><view class="title">{{"满"+item.$orig.quantity+(product.unit||'件')+''}}<block wx:if="{{item.m11===1}}"><text>{{"每"+(product.unit||'件')+"减"+item.$orig.price+"元"}}</text></block><block wx:if="{{item.m12===2}}"><text>{{"每"+(product.unit||'件')+item.m13+"折"}}</text></block></view></view></block></view><button data-event-opts="{{[['tap',[['hideService',['$event']]]]]}}" class="{{['btn','bg-'+themeColor.name]}}" bindtap="__e">完成</button></view></rf-item-popup></block><block wx:if="{{$root.g9>0}}"><rf-item-popup vue-id="3a07b446-14" title="商品参数" specClass="{{attributeValueClass}}" data-event-opts="{{[['^hide',[['hideService']]],['^show',[['showPopupService',['attributeValueClass','$0'],['product.attributeValue']]]]]}}" bind:hide="__e" bind:show="__e" bind:__l="__l" vue-slots="{{['default','content','popup']}}"><view slot="content"><text>{{''+((product.attributeValue&&product.attributeValue[0]&&product.attributeValue[0].title)+': '+(product.attributeValue&&product.attributeValue[0]&&product.attributeValue[0].value))}}</text></view><block wx:if="{{$root.g10>0}}"><view slot="right"><text class="iconfont iconyou"></text></view></block><view class="service" slot="popup"><view class="content"><block wx:for="{{product.attributeValue}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view class="row"><view class="title">{{''+(item.title+': '+item.value)+''}}</view></view></block></view><button data-event-opts="{{[['tap',[['hideService',['$event']]]]]}}" class="{{['btn','bg-'+themeColor.name]}}" bindtap="__e">完成</button></view></rf-item-popup></block></view><view data-event-opts="{{[['tap',[['toEvaluateList',['$event']]]]]}}" class="eva-section" bindtap="__e"><view class="e-header"><text class="tit">{{"评价("+(product.comment_num||0)+")"}}</text><block wx:if="{{product.match_ratio}}"><text class="tip">{{"好评率 "+product.match_ratio+"%"}}</text></block><block wx:else><text class="tip">暂无评价信息</text></block><view class="iconfont iconyou _i"></view></view><block wx:if="{{$root.g11}}"><view class="eva-box"><image class="portrait" src="{{product.evaluate&&product.evaluate[0]&&product.evaluate[0].member_head_portrait||headImg}}" mode="aspectFill"></image><view class="right"><view class="name"><text>{{''+(product.evaluate&&product.evaluate[0]&&product.evaluate[0].member_nickname||'匿名用户')+''}}</text><block wx:if="{{$root.g12>0}}"><rf-rate vue-id="3a07b446-15" size="16" disabled="true" value="{{evaluateList[0].scores}}" active-color="{{themeColor.color}}" bind:__l="__l"></rf-rate></block></view><text class="con in2line">{{product.evaluate&&product.evaluate[0]&&product.evaluate[0].content||'这个人很懒，什么都没留下~'}}</text><view class="bot"><text class="attr">{{"购买类型："+(product.evaluate&&product.evaluate[0]&&product.evaluate[0].sku_name||singleSkuText)}}</text><text class="time">{{$root.f5}}</text></view></view></view></block></view><view class="detail-desc"><view class="d-header"><text>商品详情</text></view><rf-parser vue-id="3a07b446-16" html="{{product.intro}}" lazy-load="{{true}}" bind:__l="__l"></rf-parser></view><view class="page-bottom"><view class="page-bottom-bth-wrapper"><navigator class="p-b-btn" url="/pages/index/index" open-type="switchTab"><view class="iconfont iconzhuyedefuben _i"></view><text>首页</text></navigator><navigator class="p-b-btn cart" url="/pages/cart/cart" open-type="switchTab"><view class="iconfont icongouwuche2 _i"></view><text>购物车</text><block wx:if="{{hasLogin&&cartNum&&cartNum>0}}"><rf-badge class="badge" vue-id="3a07b446-17" type="error" size="small" text="{{cartNum}}" bind:__l="__l"></rf-badge></block></navigator><view data-event-opts="{{[['tap',[['e0',['$event']]]]]}}" class="p-b-btn" bindtap="__e"><view class="iconfont iconkefu2 _i"></view><text>客服</text></view></view><block wx:if="{{$root.m14>0}}"><view class="action-btn-group"><button class="{{['action-btn','bg-'+themeColor.name]}}" disabled="{{buyBtnDisabled}}" data-event-opts="{{[['tap',[['addCart',['buy']]]]]}}" bindtap="__e">立即购买</button><button class="{{['action-btn','bg-'+themeColor.name]}}" disabled="{{addCartBtnDisabled}}" data-event-opts="{{[['tap',[['addCart',['cart']]]]]}}" bindtap="__e">加入购物车</button></view></block><view class="action-btn"><block wx:if="{{$root.m15===0}}"><button class="action-btn-submit" disabled="{{buyBtnDisabled}}">库存不足</button></block></view></view></view></block><block wx:if="{{shareClass==='show'}}"><view data-event-opts="{{[['touchmove',[['stopPrevent',['$event']]]],['tap',[['hideShareSpec',['$event']]]]]}}" class="popup spec show" catchtouchmove="__e" bindtap="__e"><view data-event-opts="{{[['tap',[['hideShareSpec',['$event']]]]]}}" class="mask" bindtap="__e"></view><view class="share-bg"><image src="{{shareBg}}"></image></view></view></block><block wx:if="{{canvasShow}}"><view class="hideCanvasView"><canvas class="hideCanvas" style="{{'width:'+((poster.width||10)+'px')+';'+('height:'+((poster.height||10)+'px')+';')}}" canvas-id="default_PosterCanvasId"></canvas></view></block><block wx:if="{{product.name}}"><rf-live vue-id="3a07b446-18" bind:__l="__l"></rf-live></block><rf-nav vue-id="3a07b446-19" bind:__l="__l"></rf-nav><block wx:if="{{kefuShow}}"><view data-event-opts="{{[['touchmove',[['stopPrevent',['$event']]]],['tap',[['hide',['$event']]]]]}}" class="popup spec show" catchtouchmove="__e" bindtap="__e"><view data-event-opts="{{[['tap',[['hide',['$event']]]]]}}" class="mask" bindtap="__e"></view><view class="kefu-bg"><image src="{{appServiceQr}}"></image></view></view></block></view>